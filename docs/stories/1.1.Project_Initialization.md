# Story 1.1: Project Initialization

## Status
Draft

## Story
**As a** Super Admin/Developer,
**I want** the project monorepo and core service scaffolding to be initialized,
**so that** a consistent development environment is established for the team.

## Acceptance Criteria
1. A monorepo structure is created and configured using pnpm workspaces.
2. A placeholder FastAPI application for the backend is created within `apps/api`.
3. A placeholder React/TypeScript application for the frontend is created within `apps/web` using Vite.
4. A `docker-compose.yml` file is created at the root to run the `api`, `web`, `worker`, `db`, and `redis` services for local development.
5. A basic CI/CD pipeline is configured in `.github/workflows/ci.yml` to run linters and placeholder tests on commit.
6. A comprehensive `README.md` file is created at the project root, containing the project title, a brief description, and clear instructions on how to run the local development environment.

## Dev Notes

This story establishes the foundational structure of the entire project based on the architecture documents.

### **Project Structure & Tooling**
*   **Monorepo:** The project is a `pnpm` workspace. The structure is defined in `pnpm-workspace.yaml` at the root. [Source: `docs/architecture/12-unified-project-structure.md`]
*   **Root `package.json`:** Must define the workspaces (e.g., `"packages": ["apps/*", "packages/*"]`) and top-level scripts for linting and testing.
*   **Applications:**
    *   `apps/web`: Frontend React/TS application.
    *   `apps/api`: Backend FastAPI application.
*   **Shared Packages:** The `packages/` directory should be created for future shared code (`shared-types`, `config`, `ui`).

### **Backend (`apps/api`)**
*   **Framework:** FastAPI [Source: `docs/architecture/03-tech-stack.md`]
*   **Language:** Python 3.12.x [Source: `docs/architecture/03-tech-stack.md`]
*   **Structure:** The initial structure should follow the layered architecture defined in `docs/architecture/11-backend-architecture.md`. Create the following directories: `src/api/v1/endpoints`, `src/core`, `src/db`, `src/models`, `src/repositories`, `src/schemas`, `src/services`, `src/worker`.
*   **Dependencies:** Create a `requirements.txt` with `fastapi`, `uvicorn`, `SQLAlchemy`, `alembic`, `pydantic`, `python-jose[cryptography]`, `passlib[bcrypt]`, `rq`, `redis`.

### **Frontend (`apps/web`)**
*   **Framework:** React 19.x with TypeScript 5.6.x [Source: `docs/architecture/03-tech-stack.md`]
*   **Build Tool:** Vite 5.x. The project should be initialized using a Vite template (e.g., `pnpm create vite apps/web --template react-ts`).
*   **Styling:** Tailwind CSS. A `tailwind.config.js` and `postcss.config.js` must be created. [Source: `docs/architecture/10-frontend-architecture.md`]
*   **Structure:** Create the initial directory structure inside `apps/web/src`: `components/ui`, `components/layouts`, `components/shared`, `components/features`, `pages`, `routes`, `services`, `hooks`, `lib`, `context`, `types`.

### **Containerization & Orchestration**
*   **`docker-compose.yml`:** This file at the project root is critical. It must define the following services:
    *   `db`: MariaDB 11.x image.
    *   `redis`: Redis image (for RQ).
    *   `api`: Builds from `apps/api/Dockerfile`. Runs the FastAPI app with `uvicorn`.
    *   `worker`: Builds from a separate `apps/api/worker.Dockerfile`. Runs the RQ worker.
    *   `web`: Uses a Caddy server to serve the static files from `apps/web/dist` and reverse proxy `/api` to the `api` service.
    [Source: `docs/architecture/14-deployment-architecture.md`, `docs/architecture/12-unified-project-structure.md`]

### **CI/CD**
*   **`ci.yml`:** A basic GitHub Actions workflow located at `.github/workflows/ci.yml`.
*   **Jobs:** It should have a single job `ci` that checks out code, installs `pnpm` and Python dependencies, and has placeholder steps for running linters and tests.
    [Source: `docs/architecture/14-deployment-architecture.md`]

## Tasks / Subtasks
- [ ] **Task 1: Initialize Monorepo Structure (AC: 1)**
    - [ ] Initialize `pnpm` at the project root.
    - [ ] Create `pnpm-workspace.yaml` defining `apps/*` and `packages/*` workspaces.
    - [ ] Create the `apps` and `packages` directories.
- [ ] **Task 2: Scaffold Backend Application (AC: 2)**
    - [ ] Create the `apps/api` directory.
    - [ ] Add a basic `package.json` to make it a pnpm workspace package.
    - [ ] Create a placeholder FastAPI application in `apps/api/src/main.py`.
    - [ ] Create the directory structure inside `apps/api/src` as specified in Dev Notes.
    - [ ] Create `apps/api/requirements.txt`.
    - [ ] Create `apps/api/Dockerfile` to run the FastAPI app.
- [ ] **Task 3: Scaffold Frontend Application (AC: 3)**
    - [ ] Use Vite to initialize a React/TypeScript project in `apps/web`.
    - [ ] Install and configure Tailwind CSS.
    - [ ] Create the directory structure inside `apps/web/src` as specified in Dev Notes.
- [ ] **Task 4: Create Docker Compose Configuration (AC: 4)**
    - [ ] Create the `docker-compose.yml` file at the project root.
    - [ ] Define the `db`, `redis`, `api`, `worker`, and `web` services.
    - [ ] Configure volumes for data persistence (`db`) and code mounting for development.
    - [ ] Configure the Caddy `web` service to reverse proxy API calls.
- [ ] **Task 5: Create Basic CI Pipeline (AC: 5)**
    - [ ] Create the `.github/workflows/` directory.
    - [ ] Create `ci.yml` with a basic build and test job that runs on push/pull_request.
- [ ] **Task 6: Create Project README (AC: 6)**
    - [ ] Create a `README.md` file at the project root.
    - [ ] Add the project title and a brief description.
    - [ ] Add clear, concise instructions on how to set up and run the local development environment using `docker-compose up`.

## Testing
*   **Backend:** Placeholder test files should be created in `apps/api/tests/` using `pytest`. For example, `apps/api/tests/test_main.py` that checks a basic `/` endpoint. [Source: `docs/architecture/16-testing-strategy.md`]
*   **Frontend:** Placeholder test files should be created co-located with components in `apps/web/src/` using `vitest`. For example, `apps/web/src/App.test.tsx`. [Source: `docs/architecture/16-testing-strategy.md`]
*   The CI pipeline should execute these placeholder tests.

## QA Results

### Review Date: 2025-10-10

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
This is a preliminary review of the story definition while in `Draft` status. No code has been written. The story is well-defined, with clear acceptance criteria, detailed developer notes, and traceability to architecture documents. The primary quality concern is the inherent risk of the implementation itself.

### Refactoring Performed
None.

### Compliance Check
- Coding Standards: [✓] (N/A for draft)
- Project Structure: [✓] (Story aligns with documentation)
- Testing Strategy: [✗] (The story's `Testing` section is a good start but lacks the specific, risk-based scenarios required to mitigate the identified critical risk.)
- All ACs Met: [✗] (Story is in Draft)

### Improvements Checklist
- [ ] **CRITICAL:** The `Testing` section of this story must be updated to include the specific, high-priority test scenarios identified in the risk profile, particularly those for validating the Docker Compose environment.
- [ ] Consider creating a small, automated script to validate the local environment's health after `docker-compose up`.

### Security Review
N/A for this structural story.

### Performance Considerations
N/A for this structural story.

### Files Modified During Review
None.

### Gate Status
Gate: **FAIL** → `docs/qa/gates/1.1-project-initialization.yml`
Risk profile: `docs/qa/assessments/1.1-project-initialization-risk-20251010.md`

### Recommended Status
[✗ Changes Required - See unchecked items above]